<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Strawberry Multiverse üçì</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&display=swap');

        :root {
            --pink: #ffb7c5;
            --hot-pink: #ff4d6d;
            --dark-pink: #8a263a;
            --cream: #fff5f5;
        }

        * { touch-action: none; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #220a0e;
            font-family: 'Silkscreen', cursive;
            overflow: hidden; display: flex; justify-content: center; align-items: center;
        }

        #game-container {
            width: 100%; height: 100%;
            max-width: 450px; max-height: 850px;
            background: var(--cream);
            position: relative; overflow: hidden;
            border: 4px solid white;
            box-shadow: 0 0 20px rgba(138, 38, 58, 0.5);
            color: var(--dark-pink);
        }

        /* Hidden YouTube Player */
        #youtube-player { position: absolute; visibility: hidden; width: 1px; height: 1px; pointer-events: none; }

        #music-toggle {
            position: absolute; top: 20px; right: 20px;
            z-index: 1000; background: white; border: 2px solid var(--hot-pink);
            border-radius: 50%; width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 20px; box-shadow: 0 4px 0 var(--pink);
        }

        .screen {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            text-align: center; padding: 20px; z-index: 10;
            background: var(--cream);
        }

        .hidden { display: none !important; }

        .btn {
            background: var(--hot-pink); color: white;
            border: none; padding: 15px 10px; border-radius: 50px;
            font-family: 'Silkscreen', cursive; font-size: 13px;
            cursor: pointer; box-shadow: 0 5px 0 var(--dark-pink);
            margin: 8px 0; width: 90%; transition: 0.1s;
        }

        .btn:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--dark-pink); }

        #no-btn { position: absolute; z-index: 9999; width: auto !important; padding: 10px 20px; background: #ff85a1; }

        canvas { display: none; width: 100%; height: 100%; background: #fff0f3; }

        #quiz-options { display: flex; flex-direction: column; align-items: center; width: 100%; }

        #letter-overlay {
            position: absolute; inset: 5%; background: #fffafa;
            border: 4px solid var(--hot-pink); border-radius: 20px;
            padding: 20px; z-index: 5000; overflow-y: auto;
            display: none; flex-direction: column;
        }

        h1, h2, p { color: var(--dark-pink); margin: 10px 0; }
        .letter-body { font-family: sans-serif; font-size: 15px; line-height: 1.6; color: var(--dark-pink); text-align: left; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="youtube-player"></div>
    <div id="music-toggle" onclick="toggleMusic()">üéµ</div>

    <div id="ui-layer" style="position:absolute; top:20px; left:20px; display:none; z-index:100; pointer-events: none;">
        <div id="heart-bar">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    </div>

    <div id="scr-intro" class="screen">
        <div style="font-size: 60px;">üçì</div>
        <h1>STRAWBERRY<br>MULTIVERSE</h1>
        <button class="btn" onclick="startAdventure()">START ADVENTURE</button>
    </div>

    <div id="scr-love2" class="screen hidden">
        <h1>DO YOU REALLY<br>LOVE ME?</h1>
        <button class="btn" onclick="nextLevel()">YES!</button>
        <button id="no-btn" class="btn">NO</button>
    </div>

    <div id="instruction-screen" class="screen hidden">
        <h2 id="ins-title"></h2>
        <p id="ins-text"></p>
        <button class="btn" onclick="startActualLvl()">I'M READY!</button>
    </div>

    <div id="scr-quiz" class="screen hidden">
        <h2 id="q-num" style="font-size: 14px;">SYNC Q1</h2>
        <p id="q-text" style="font-size: 16px; margin-bottom: 20px;"></p>
        <div id="quiz-options"></div>
    </div>

    <canvas id="mainCanvas"></canvas>

    <div id="scr-final" class="screen hidden">
        <h1>VICTORY!</h1>
        <div style="font-size: 60px; margin: 20px;">üçì‚ú®</div>
        <button class="btn" onclick="openLetter()">READ MY LETTER üíå</button>
    </div>

    <div id="letter-overlay">
        <h2>Happy 1st Month Aliii! üçì</h2>
        <div class="letter-body">
            Dear Lexi Merindo,<br><br>
            They say the first month is just the beginning, but with you, it feels like I've found my favorite person in the entire multiverse.<br><br>
            Even across the distance, every video call and every text makes me fall for you all over again. I can't wait for that first airport hug.<br><br>
            I love you more than all the strawberries in the world.<br><br>
            Yours Forever,<br>
            Cj Morales
        </div>
        <button class="btn" onclick="closeLetter()">CLOSE</button>
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
    let player;
    const state = { 
        level: 0, hearts: 5, quizIndex: 0, 
        frames: 0, objects: [], isPaused: true,
        player: { x: 200, y: 400, targetX: 200, targetY: 400 }
    };

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('youtube-player', {
            height: '0', width: '0',
            videoId: 'Uj93hicGDNc',
            playerVars: { 'autoplay': 0, 'controls': 0, 'loop': 1, 'playlist': 'Uj93hicGDNc' },
            events: { 'onReady': onPlayerReady }
        });
    }

    function onPlayerReady(event) {
        console.log("Music Player Ready");
    }

    function startAdventure() {
        if (player && player.playVideo) {
            player.playVideo();
        }
        document.getElementById('scr-intro').classList.add('hidden');
        document.getElementById('scr-love2').classList.remove('hidden');
    }

    function toggleMusic() {
        if (!player) return;
        const status = player.getPlayerState();
        if (status === 1) { 
            player.pauseVideo();
            document.getElementById('music-toggle').innerText = "üîá";
        } else {
            player.playVideo();
            document.getElementById('music-toggle').innerText = "üéµ";
        }
    }

    function nextLevel() {
        state.level++;
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        document.getElementById('mainCanvas').style.display = 'none';
        state.isPaused = true;

        const data = [
            null,
            {t: "LVL 1: SYNC", d: "Answer 10 questions to sync our hearts!"},
            {t: "LVL 2: HARVEST", d: "Catch the strawberries but avoid the heartbreaks! Drag to move."},
            {t: "FINAL: ADVENTURE", d: "Read the final message."}
        ][state.level];

        if(state.level === 3) {
            document.getElementById('scr-final').classList.remove('hidden');
        } else {
            const ins = document.getElementById('instruction-screen');
            ins.classList.remove('hidden');
            document.getElementById('ins-title').innerText = data.t;
            document.getElementById('ins-text').innerText = data.d;
        }
    }

    function startActualLvl() {
        document.getElementById('instruction-screen').classList.add('hidden');
        document.getElementById('ui-layer').style.display = 'block';
        state.isPaused = false;
        state.frames = 0; 
        state.objects = [];

        if (state.level === 1) {
            startQuiz();
        } else if (state.level === 2) {
            document.getElementById('mainCanvas').style.display = 'block';
            runGameLoop();
        }
    }

    function startQuiz() {
        const scr = document.getElementById('scr-quiz');
        scr.classList.remove('hidden');

        const quizData = [
            { q: "Who is more likely to cry during our first airport hug?", options: ["Me (I'm a baby)", "You (Emotional support human)", "Both (Total sob fest)"] },
            { q: "Who yaps the most during our late-night Video calls?", options: ["The Yapper-in-Chief (You)", "The Nonchalant Listener (Me)", "We both never shut up tbh"] },
            { q: "Who usually sends the first 'Good Morning' text?", options: ["The early bird (Me)", "The 'sleepyhead' (You)", "Whoever wakes up first"] },
            { q: "Who is the master of sending the cutest reels/TikToks?", options: ["The Content Curator (Me)", "The Doomscroller (You)", "My algorithm is just you"] },
            { q: "Who is more likely to fall asleep first while on call?", options: ["The Sleepy Princess (Me)", "The Midnight Owl (You)", "FaceTime sleep hits diff"] },
            { q: "Who fell in love first (even through the screen)?", options: ["Me (I folded immediately)", "You (Keeping it lowkey)", "It was a mutual serve"] },
            { q: "Who is most excited for our very first 'real life' date?", options: ["Me (Counting the seconds)", "You (Main character energy)", "Both vibrating with joy"] },
            { q: "Who gives the best digital comfort when distance is hard?", options: ["Me (Virtual hug specialist)", "You (The calm to my storm)", "Our Wi-Fi love language"] },
            { q: "Who is the most stubborn when it's time to hang up?", options: ["'No, you hang up first!' (Me)", "'I'm staying on' (You)", "We just sleep on call"] },
            { q: "Are you ready to be my favorite person in every universe?", options: ["Yes (Real)", "Yes (No cap)", "Yes (Endgame)"] }
        ];

        const currentQ = quizData[state.quizIndex];
        document.getElementById('q-num').innerText = `SYNC Q${state.quizIndex + 1}`;
        document.getElementById('q-text').innerText = currentQ.q;

        const optContainer = document.getElementById('quiz-options');
        optContainer.innerHTML = '';

        currentQ.options.forEach(optionText => {
            const b = document.createElement('button');
            b.className = 'btn';
            b.innerText = optionText;
            b.onclick = () => {
                state.quizIndex++;
                if (state.quizIndex < quizData.length) startQuiz();
                else { 
                    scr.classList.add('hidden'); 
                    nextLevel(); 
                }
            };
            optContainer.appendChild(b);
        });
    }

    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');

    function runGameLoop() {
        if(state.isPaused) return;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        state.player.x += (state.player.targetX - state.player.x) * 0.15;

        if(state.frames % 30 === 0) state.objects.push({x: Math.random()*(canvas.width-30), y: -50, t: Math.random()>0.2?'üçì':'üíî'});
        
        state.objects.forEach((o, i) => {
            o.y += 5;
            ctx.font = "30px Arial"; ctx.fillText(o.t, o.x, o.y);
            if(o.y > canvas.height - 80 && Math.abs(o.x - state.player.x) < 40) {
                if(o.t === 'üíî') state.hearts--;
                state.objects.splice(i, 1);
                document.getElementById('heart-bar').innerText = "‚ù§Ô∏è".repeat(Math.max(0, state.hearts));
            }
        });
        
        ctx.font = "50px Arial"; ctx.fillText("üß∫", state.player.x - 25, canvas.height - 40);
        state.frames++;
        
        if(state.frames > 600) nextLevel();
        else requestAnimationFrame(runGameLoop);
    }

    canvas.addEventListener('mousemove', (e) => state.player.targetX = e.clientX - canvas.getBoundingClientRect().left);
    canvas.addEventListener('touchmove', (e) => {
        state.player.targetX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
    }, {passive: true});

    const noBtn = document.getElementById('no-btn');
    noBtn.addEventListener('mouseover', () => { 
        noBtn.style.left = Math.random()*70+'%'; 
        noBtn.style.top = Math.random()*70+'%'; 
    });
    noBtn.addEventListener('touchstart', (e) => {
        e.preventDefault();
        noBtn.style.left = Math.random()*70+'%'; 
        noBtn.style.top = Math.random()*70+'%'; 
    });

    function openLetter() { document.getElementById('letter-overlay').style.display = 'flex'; }
    function closeLetter() { document.getElementById('letter-overlay').style.display = 'none'; }
    function resize() { 
        canvas.width = document.getElementById('game-container').clientWidth; 
        canvas.height = document.getElementById('game-container').clientHeight; 
    }
    resize();
    window.addEventListener('resize', resize);
</script>
</body>
</html>
