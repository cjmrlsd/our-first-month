<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Strawberry Multiverse üçì</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&display=swap');

        :root {
            --pink: #ffb7c5;
            --hot-pink: #ff4d6d;
            --dark-pink: #8a263a;
            --cream: #fff5f5;
        }

        * { touch-action: none; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #220a0e;
            font-family: 'Silkscreen', cursive;
            overflow: hidden; display: flex; justify-content: center; align-items: center;
        }

        #game-container {
            width: 100%; height: 100%;
            max-width: 450px; max-height: 850px;
            background: var(--cream);
            position: relative; overflow: hidden;
            border: 4px solid white;
            box-shadow: 0 0 20px rgba(138, 38, 58, 0.5);
            color: var(--dark-pink);
        }

        /* Hidden YouTube Player */
        #youtube-player { position: absolute; visibility: hidden; width: 1px; height: 1px; }

        #music-toggle {
            position: absolute; top: 20px; right: 20px;
            z-index: 1000; background: white; border: 2px solid var(--hot-pink);
            border-radius: 50%; width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; font-size: 20px; box-shadow: 0 4px 0 var(--pink);
        }

        .screen {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            text-align: center; padding: 20px; z-index: 10;
            background: var(--cream);
        }

        .hidden { display: none !important; }

        .btn {
            background: var(--hot-pink); color: white;
            border: none; padding: 15px 10px; border-radius: 50px;
            font-family: 'Silkscreen', cursive; font-size: 13px;
            cursor: pointer; box-shadow: 0 5px 0 var(--dark-pink);
            margin: 8px 0; width: 90%; transition: 0.1s;
        }

        .btn:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--dark-pink); }

        #no-btn { position: absolute; z-index: 9999; width: auto !important; padding: 10px 20px; background: #ff85a1; }

        canvas { display: none; width: 100%; height: 100%; background: #fff0f3; }

        #quiz-options { display: flex; flex-direction: column; align-items: center; width: 100%; }

        #letter-overlay {
            position: absolute; inset: 5%; background: #fffafa;
            border: 4px solid var(--hot-pink); border-radius: 20px;
            padding: 20px; z-index: 5000; overflow-y: auto;
            display: none; flex-direction: column;
        }

        h1, h2, p { color: var(--dark-pink); margin: 10px 0; }
        .letter-body { font-family: sans-serif; font-size: 15px; line-height: 1.6; color: var(--dark-pink); text-align: left; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="youtube-player"></div>
    <div id="music-toggle" onclick="toggleMusic()">üéµ</div>

    <div id="ui-layer" style="position:absolute; top:20px; left:20px; display:none; z-index:100; pointer-events: none;">
        <div id="heart-bar">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
    </div>

    <div id="scr-intro" class="screen">
        <div style="font-size: 60px;">üçì</div>
        <h1>STRAWBERRY<br>MULTIVERSE</h1>
        <button class="btn" onclick="startAdventure()">START ADVENTURE</button>
    </div>

    <div id="scr-love2" class="screen hidden">
        <h1>DO YOU REALLY<br>LOVE ME?</h1>
        <button class="btn" onclick="nextLevel()">YES!</button>
        <button id="no-btn" class="btn">NO</button>
    </div>

    <div id="instruction-screen" class="screen hidden">
        <h2 id="ins-title"></h2>
        <p id="ins-text"></p>
        <button class="btn" onclick="startActualLvl()">I'M READY!</button>
    </div>

    <div id="scr-quiz" class="screen hidden">
        <h2 id="q-num" style="font-size: 14px;">SYNC Q1</h2>
        <p id="q-text" style="font-size: 16px; margin-bottom: 20px;"></p>
        <div id="quiz-options"></div>
    </div>

    <canvas id="mainCanvas"></canvas>

    <div id="scr-final" class="screen hidden">
        <h1>VICTORY!</h1>
        <div style="font-size: 60px; margin: 20px;">üçì‚ú®</div>
        <button class="btn" onclick="openLetter()">READ MY LETTER üíå</button>
    </div>

    <div id="letter-overlay">
        <h2>Happy 1st Month Aliii! üçì</h2>
        <div class="letter-body">
            Dear Lexi Merindo,<br><br>
            They say the first month is just the beginning, but with you, it feels like I've found my favorite person in the entire multiverse.<br><br>
            Even across the distance, every video call and every text makes me fall for you all over again. I can't wait for that first airport hug.<br><br>
            I love you more than all the strawberries in the world.<br><br>
            Yours Forever,<br>
            Cj Morales
        </div>
        <button class="btn" onclick="closeLetter()">CLOSE</button>
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
    let player;
    const state = { 
        level: 0, hearts: 5, quizIndex: 0, 
        frames: 0, objects: [], isPaused: true,
        player: { x: 200, y: 400, targetX: 200, targetY: 400 }
    };

    // Initialize YouTube Player
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('youtube-player', {
            height: '0', width: '0',
            videoId: 'Uj93hicGDNc',
            events: { 'onReady': onPlayerReady }
        });
    }

    function onPlayerReady(event) {
        // Player is ready but won't play until startAdventure()
    }

    function startAdventure() {
        if (player && player.playVideo) player.playVideo();
        goToStep(1);
    }

    function toggleMusic() {
        const status = player.getPlayerState();
        if (status === 1) { // Playing
            player.pauseVideo();
            document.getElementById('music-toggle').innerText = "üîá";
        } else {
            player.playVideo();
