<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Strawberry Multiverse üçì</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&display=swap');

        :root {
            --pink: #ffb7c5;
            --hot-pink: #ff4d6d;
            --dark-pink: #8a263a;
            --cream: #fff5f5;
        }

        * { touch-action: none; box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #220a0e;
            font-family: 'Silkscreen', cursive;
            overflow: hidden; display: flex; justify-content: center; align-items: center;
        }

        #game-container {
            width: 100%; height: 100%;
            max-width: 450px; max-height: 850px;
            background: var(--cream);
            position: relative; overflow: hidden;
            border: 4px solid white;
            box-shadow: 0 0 30px rgba(255, 77, 109, 0.3);
        }

        /* Hidden but active YT player */
        #youtube-player { position: absolute; top: -100px; left: -100px; width: 1px; height: 1px; pointer-events: none; }

        .screen {
            position: absolute; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            text-align: center; padding: 20px; z-index: 10;
            background: var(--cream);
            transition: opacity 0.4s ease;
        }

        .hidden { display: none !important; opacity: 0; }

        /* Rapid Loading Bar */
        #loader-container { width: 80%; text-align: center; margin-top: 20px; }
        #loader-wrapper {
            width: 100%; height: 35px;
            background: white; border-radius: 10px;
            position: relative; overflow: hidden;
            border: 3px solid var(--dark-pink);
        }

        #loader-bar {
            width: 0%; height: 100%;
            background: repeating-linear-gradient(45deg, var(--hot-pink), var(--hot-pink) 10px, #ff85a1 10px, #ff85a1 20px);
            transition: width 0.1s linear;
        }

        #percent-text { margin-top: 10px; font-size: 18px; color: var(--dark-pink); }

        .btn {
            background: var(--hot-pink); color: white;
            border: none; padding: 18px; border-radius: 50px;
            font-family: 'Silkscreen', cursive; font-size: 15px;
            cursor: pointer; box-shadow: 0 6px 0 var(--dark-pink);
            width: 85%; transition: 0.1s;
        }

        .btn:active { transform: translateY(3px); box-shadow: 0 2px 0 var(--dark-pink); }
        #no-btn { position: absolute; z-index: 9999; padding: 10px 20px; background: #ff85a1; }
        canvas { display: none; width: 100%; height: 100%; background: #fff0f3; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="youtube-player"></div>

    <div id="scr-intro" class="screen">
        <div style="font-size: 70px; margin-bottom: 10px; animation: bounce 1s infinite alternate;">üçì</div>
        <h1 style="font-size: 26px; line-height: 1.2;">STRAWBERRY<br>MULTIVERSE</h1>
        
        <div id="loader-container">
            <div id="loader-wrapper">
                <div id="loader-bar"></div>
            </div>
            <div id="percent-text">0%</div>
        </div>

        <button id="start-btn" class="btn hidden" onclick="startAdventure()">START ADVENTURE</button>
    </div>

    <div id="scr-love2" class="screen hidden">
        <h1 style="font-size: 22px;">DO YOU REALLY<br>LOVE ME?</h1>
        <button class="btn" onclick="nextLevel()">YES!</button>
        <button id="no-btn" class="btn">NO</button>
    </div>

    <div id="instruction-screen" class="screen hidden">
        <h2 id="ins-title"></h2>
        <p id="ins-text" style="font-family: sans-serif; font-weight: bold;"></p>
        <button class="btn" onclick="startActualLvl()">LET'S GO!</button>
    </div>

    <div id="scr-quiz" class="screen hidden">
        <h2 id="q-num" style="font-size: 14px;"></h2>
        <p id="q-text" style="font-size: 18px; margin: 20px 0;"></p>
        <div id="quiz-options" style="width: 100%;"></div>
    </div>

    <canvas id="mainCanvas"></canvas>

    <div id="scr-final" class="screen hidden">
        <h1 style="font-size: 28px;">VICTORY!</h1>
        <div style="font-size: 70px; margin: 20px;">üçì‚ú®</div>
        <button class="btn" onclick="document.getElementById('letter-overlay').style.display='flex'">READ MY LETTER üíå</button>
    </div>

    <div id="letter-overlay" style="position:absolute; inset:5%; background:white; border:4px solid var(--hot-pink); border-radius:20px; padding:20px; z-index:100; display:none; flex-direction:column; overflow-y:auto;">
        <h2 style="font-size: 16px;">Happy 1st Month Aliii! üçì</h2>
        <p style="text-align: left; line-height: 1.6; font-family: sans-serif; color: var(--dark-pink);">
            Dear Lexi Merindo,<br><br>
            They say the first month is just the beginning, but with you, it feels like I've found my favorite person in the entire multiverse. I love you more than all the strawberries in the world.<br><br>
            Yours Forever,<br>Cj Morales
        </p>
        <button class="btn" onclick="this.parentElement.style.display='none'">CLOSE</button>
    </div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
    let player;
    let progress = 0;
    const state = { level: 0, hearts: 5, score: 0, quizIndex: 0, frames: 0, objects: [], isPaused: true, player: { x: 200, targetX: 200 } };

    // 1. High-Speed Loading Animation
    function fastLoad() {
        let speed = 2; // Fast increment
        let interval = setInterval(() => {
            progress += speed;
            if (progress >= 100) {
                progress = 100;
                clearInterval(interval);
                showStartButton();
            }
            document.getElementById('loader-bar').style.width = progress + '%';
            document.getElementById('percent-text').innerText = Math.floor(progress) + '%';
        }, 30);
    }

    function showStartButton() {
        document.getElementById('loader-container').style.display = 'none';
        document.getElementById('start-btn').classList.remove('hidden');
    }

    // 2. YouTube Music Immediate Play Logic
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('youtube-player', {
            height: '1', width: '1', videoId: 'Uj93hicGDNc',
            playerVars: { 'autoplay': 1, 'controls': 0, 'loop': 1, 'playlist': 'Uj93hicGDNc', 'mute': 1 },
            events: { 
                'onReady': (e) => {
                    e.target.playVideo(); // Pre-load audio
                    fastLoad(); // Start visual loading
                }
            }
        });
    }

    function startAdventure() {
        if (player) {
            player.unMute();
            player.setVolume(100);
            player.playVideo();
        }
        document.getElementById('scr-intro').classList.add('hidden');
        document.getElementById('scr-love2').classList.remove('hidden');
    }

    // Navigation & Game Logic
    function nextLevel() {
        state.level++;
        document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
        document.getElementById('mainCanvas').style.display = 'none';
        state.isPaused = true;

        if(state.level === 3) { document.getElementById('scr-final').classList.remove('hidden'); return; }
        
        const data = [null, {t: "LVL 1: SYNC", d: "Answer the questions to sync our hearts!"}, {t: "LVL 2: HARVEST", d: "Catch 15 Strawberries! Avoid the üíî!"}][state.level];
        const ins = document.getElementById('instruction-screen');
        ins.classList.remove('hidden');
        document.getElementById('ins-title').innerText = data.t;
        document.getElementById('ins-text').innerText = data.d;
    }

    function startActualLvl() {
        document.getElementById('instruction-screen').classList.add('hidden');
        state.isPaused = false;
        if (state.level === 1) startQuiz();
        else { document.getElementById('mainCanvas').style.display = 'block'; runGameLoop(); }
    }

    function startQuiz() {
        const scr = document.getElementById('scr-quiz'); scr.classList.remove('hidden');
        const quizData = [
            { q: "Who is more likely to cry during our first airport hug?", options: ["Me", "You", "Both"] },
            { q: "Who yaps the most during our late-night Video calls?", options: ["Me", "You", "Both"] },
            { q: "Ready for our multiverse adventure?", options: ["Yes (Real)", "Yes (No Cap)", "Endgame"] }
        ];
        const currentQ = quizData[state.quizIndex];
        document.getElementById('q-num').innerText = `SYNC Q${state.quizIndex + 1}`;
        document.getElementById('q-text').innerText = currentQ.q;
        const optContainer = document.getElementById('quiz-options');
        optContainer.innerHTML = '';
        currentQ.options.forEach(opt => {
            const b = document.createElement('button'); b.className = 'btn'; b.innerText = opt;
            b.onclick = () => { state.quizIndex++; if (state.quizIndex < quizData.length) startQuiz(); else nextLevel(); };
            optContainer.appendChild(b);
        });
    }

    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    function runGameLoop() {
        if(state.isPaused) return;
        ctx.clearRect(0,0,canvas.width,canvas.height);
        state.player.x += (state.player.targetX - state.player.x) * 0.2;
        if(state.frames % 35 === 0) state.objects.push({x: Math.random()*(canvas.width-30), y: -50, t: Math.random()>0.2?'üçì':'üíî'});
        state.objects.forEach((o, i) => {
            o.y += 6; ctx.font = "30px Arial"; ctx.fillText(o.t, o.x, o.y);
            if(o.y > canvas.height - 100 && Math.abs(o.x - state.player.x) < 50) {
                if(o.t === 'üçì') state.score++;
                state.objects.splice(i, 1);
            }
        });
        ctx.font = "60px Arial"; ctx.fillText("üß∫", state.player.x - 30, canvas.height - 50);
        state.frames++;
        if(state.score >= 15) nextLevel();
        else requestAnimationFrame(runGameLoop);
    }

    canvas.addEventListener('touchmove', (e) => {
        e.preventDefault();
        state.player.targetX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
    }, {passive: false});

    const noBtn = document.getElementById('no-btn');
    noBtn.addEventListener('mouseover', () => { noBtn.style.left = Math.random()*70+'%'; noBtn.style.top = Math.random()*70+'%'; });

    function resize() { canvas.width = 450; canvas.height = 850; }
    resize();
</script>

<style>
    @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-10px); } }
</style>
</body>
</html>
